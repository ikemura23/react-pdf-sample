# React PDF Sample Project

## プロジェクト概要

このプロジェクトは React + TypeScript + Vite を使用した PDF ビューアーアプリケーションです。宅配業務の専用地図（test.pdf）をブラウザで表示し、配達員が効率的に配達情報を確認できることを目的としています。

## プロジェクトの目的

### 主要な機能要件

- **PDF 表示**: 宅配業務の専用地図（test.pdf）をブラウザで表示
- **大容量 PDF 対応**: 大きな 1 枚の PDF をスムーズに表示する実験
- **座標ズーム表示**: メニューからクリックされたアイテムから PDF の指定座標をズーム表示
- **配達情報確認**: 配達員が PDF の配達メモ（コメントや入口、受取時間）を確認
- **マルチデバイス対応**: PC およびスマートフォンでの表示に対応

### 技術的な検証項目

- react-pdf ライブラリの大容量 PDF 表示性能
- 座標指定によるズーム機能の実装可能性
- モバイルデバイスでの表示最適化
- 配達業務に特化した UI/UX の設計

### 対象ユーザー

- **配達員**: PC およびスマートフォンで PDF ビューアーとして使用
- **配達業務管理者**: 配達ルートや配達情報の確認

### 制約事項

- **PDF 生成機能は不要**: 既存の PDF ファイルの表示のみ
- **PDF 編集機能は不要**: 別システムで PDF の修正を行うため
- **読み取り専用**: 配達員は PDF の内容を確認するのみ

## 技術スタック

- **フレームワーク**: React 19.1.1
- **言語**: TypeScript 5.8.3
- **ビルドツール**: Vite 7.1.6
- **リンター・フォーマッター**: Biome 2.2.4
- **PDF 表示**: [react-pdf](https://github.com/wojtekmaj/react-pdf) - PDF を画像のように簡単に表示
- **PDF.js Worker**: pdfjs-dist (最新版、.mjs 拡張子対応)
- **静的ファイルコピー**: vite-plugin-static-copy (cMap ファイル用)
- **Node.js 型定義**: @types/node
- **PDF 生成**: 未実装（今後追加予定）

## Biome 設定

### 設定ファイル

- `biome.json` - Biome の設定ファイル

### 主要な設定内容

#### フォーマッター設定

- インデント: スペース 2 文字
- 行の最大長: 100 文字
- 改行コード: LF
- セミコロン: 必要に応じて
- クォート: シングルクォート
- JSX クォート: ダブルクォート

#### リンター設定

- **推奨ルール**: 有効
- **未使用変数**: エラー
- **未使用インポート**: エラー
- **非 null アサーション**: 警告
- **console.log**: 警告
- **explicit any**: 警告
- **配列インデックスキー**: 警告

### 利用可能なコマンド

```bash
# リントチェック
npm run lint

# リント自動修正
npm run lint:fix

# コードフォーマット
npm run format

# フォーマットチェック
npm run format:check

# リントとフォーマットの両方をチェック
npm run check

# リントとフォーマットの両方を自動修正
npm run check:fix
```

## 開発環境セットアップ

1. 依存関係のインストール

```bash
npm install
```

2. 開発サーバーの起動

```bash
npm run dev
```

3. ビルド

```bash
npm run build
```

## プロジェクト構造

```
react-pdf-sample/
├── src/
│   ├── App.tsx              # メインアプリケーションコンポーネント
│   ├── App.css              # アプリケーションスタイル
│   ├── main.tsx             # エントリーポイント
│   ├── index.css            # グローバルスタイル
│   ├── components/          # Reactコンポーネント
│   │   ├── PdfViewer.tsx    # PDF表示コンポーネント
│   │   ├── AppHeader.tsx    # アプリケーションヘッダー
│   │   ├── AppHeader.css    # ヘッダースタイル
│   │   ├── Drawer.tsx       # サイドドロワーメニュー
│   │   ├── Drawer.css       # ドロワースタイル
│   │   ├── DrawerToggleButton.tsx # ドロワー切り替えボタン
│   │   ├── DrawerToggleButton.css # ボタンスタイル
│   │   ├── DebugDisplay.tsx # デバッグ情報表示
│   │   └── DebugDisplay.css # デバッグ表示スタイル
│   ├── data/
│   │   └── menuItems.ts     # メニューアイテムデータ
│   ├── types/
│   │   └── index.ts         # TypeScript型定義
│   └── assets/              # 静的アセット
├── public/                  # パブリックファイル
│   ├── test.pdf             # 宅配業務専用地図PDF
│   └── nakano.pdf           # 追加のPDFファイル
├── biome.json              # Biome設定ファイル
├── package.json            # プロジェクト設定
├── vite.config.ts          # Vite設定（cMapファイルコピー設定済み）
└── tsconfig.node.json      # Node.js用TypeScript設定
```

## PDF 機能について

### 現在の状況

- ✅ 基本的な React アプリケーションのテンプレート状態
- ✅ test.pdf ファイルが public ディレクトリに配置済み
- ✅ nakano.pdf ファイルも追加で配置済み
- ✅ react-pdf ライブラリの導入完了
- ✅ PDF.js worker の設定完了（.mjs 拡張子対応）
- ✅ Vite 設定で cMap ファイルのコピー設定完了
- ✅ 基本的な PDF 表示機能の実装完了
- ✅ 座標ズーム機能の実装完了
- ✅ サイドドロワーメニューの実装完了
- ✅ デバッグ表示機能の実装完了
- ✅ レスポンシブ対応の基本実装完了

### 実装予定機能

#### 1. PDF 表示機能

- ✅ test.pdf の読み込みと表示
- ⏳ ページの拡大・縮小機能
- ⏳ スクロール・パン操作

#### 2. 座標ズーム機能

- ✅ メニューアイテムクリック時の座標指定
- ✅ 指定座標への自動ズーム・移動
- ⏳ ズームレベルの調整

#### 4. レスポンシブ対応

- ✅ PC での表示最適化
- ✅ スマートフォンでの表示最適化
- ⏳ タッチ操作のサポート

### 技術的な課題

- **大容量 PDF の読み込み時間**: test.pdf のサイズに応じた最適化
- **メモリ使用量**: ブラウザでのメモリ効率
- **モバイル表示**: 小さな画面での操作性
- **座標精度**: 正確な位置指定とズーム

### 推奨ライブラリ

- **react-pdf**: PDF 表示のメインライブラリ
- **react-hotkeys-hook**: キーボードショートカット

## 開発方針

### 段階的実装

1. **Phase 1**: ✅ 基本的な PDF 表示機能の実装
2. **Phase 2**: ✅ ズーム・パン機能の追加
3. **Phase 3**: ✅ 座標指定ズーム機能の実装
4. **Phase 5**: ✅ モバイル最適化

### パフォーマンス最適化

- PDF の遅延読み込み
- 画像の最適化
- メモリ使用量の監視
- キャッシュ戦略の実装

## 実装済み機能

### Phase 1: 基本的な PDF 表示機能 ✅

- **PdfViewer コンポーネント**: react-pdf を使用した PDF 表示コンポーネント
- **PDF.js Worker 設定**: 最新の.mjs 拡張子に対応した worker 設定
- **Vite 設定最適化**: cMap ファイルの自動コピー設定
- **TypeScript 設定**: Node.js 型定義の追加
- **エラーハンドリング**: PDF.js worker の読み込みエラー解決

### Phase 2: ズーム・パン機能 ✅

- **座標スクロール機能**: 指定座標への自動スクロール
- **スムーズスクロール**: 滑らかなスクロールアニメーション
- **スクロール完了検知**: スクロール完了後のコールバック処理

### Phase 3: 座標指定ズーム機能 ✅

- **メニューシステム**: サイドドロワーによる配達員メニュー
- **座標データ管理**: TypeScript型定義による座標データ管理
- **メニューアイテムクリック**: 座標指定による自動ズーム機能
- **キーボード操作**: ESCキーによるドロワー閉じる機能

### Phase 5: モバイル最適化 ✅

- **レスポンシブデザイン**: PC・スマートフォン対応
- **タッチ操作**: モバイルデバイスでの操作性向上
- **デバッグ表示**: 開発時の情報表示機能

### 技術的な実装詳細

- **Worker 設定**: `import.meta.url`を使用した推奨される設定方法
- **cMap 対応**: 非ラテン文字を含む PDF の正しい表示
- **型安全性**: TypeScript による型チェック強化
- **コンポーネント設計**: 再利用可能なコンポーネント設計
- **状態管理**: React Hooks による効率的な状態管理

## 注意事項

- ESLint は削除され、Biome に完全移行済み
- コードの品質管理は Biome で統一
- コミット前には`npm run check`の実行を推奨
- test.pdf は宅配業務の実際のデータを含む可能性があるため、機密性に注意
- 大容量 PDF の表示性能を重視した実装を行う
- PDF.js worker は.mjs 拡張子を使用（古い.js 拡張子は非対応）

## ⚠️ 重要な開発ルール

### コード修正時の制約事項

- **絶対にコミット・プッシュしない**: コードの修正のみにとどめる
- **ユーザーの許可なしにgit操作を実行しない**: `git add`, `git commit`, `git push`は禁止
- **修正内容の説明のみ**: 実装した修正内容を説明し、ユーザーが手動でコミット・プッシュする
- **ビルドテストのみ許可**: `npm run build`などのビルドテストは実行可能
- **リンターチェックのみ許可**: `npm run check`などの品質チェックは実行可能

### 修正後の推奨フロー

1. コード修正を実装
2. ビルドテストを実行してエラーがないことを確認
3. 修正内容をユーザーに説明
4. ユーザーが手動でコミット・プッシュを実行

## 現在の実装状況サマリー

### 完了済み機能

1. **PDF 表示システム**: react-pdf による PDF 表示機能
2. **座標ズーム機能**: メニューから指定座標への自動ズーム
3. **サイドドロワーメニュー**: 配達員リストと座標データ管理
4. **レスポンシブ対応**: PC・スマートフォン両対応
5. **デバッグ機能**: 開発時の情報表示とデバッグ支援
6. **キーボード操作**: ESCキーによるメニュー操作

### 次の実装予定

1. **ズームレベル調整**: 拡大・縮小機能の実装
2. **配達情報表示**: 配達メモ、入口情報、受取時間の表示
3. **タッチ操作強化**: モバイルでの操作性向上

### 技術的成果

- TypeScript による型安全性の確保
- コンポーネントベースの設計による保守性向上
- レスポンシブデザインによるマルチデバイス対応
- 効率的な状態管理によるパフォーマンス最適化
